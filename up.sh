#!/bin/bash
# Debian 12 ä¸€é”®ç³»ç»Ÿæ›´æ–°è„šæœ¬ï¼ˆç²¾ç®€ä¼˜åŒ–ç‰ˆï¼‰
# ä½œè€…: ChatGPT GPT-5

echo "========================================"
echo "ğŸš€ Debian 12 ä¸€é”®æ›´æ–°å¼€å§‹ $(date)"
echo "========================================"

# æ£€æŸ¥æ˜¯å¦ä¸º root ç”¨æˆ·
if [ "$EUID" -ne 0 ]; then
  echo "âŒ è¯·ä½¿ç”¨ root æƒé™è¿è¡Œæ­¤è„šæœ¬ï¼"
  echo "ğŸ‘‰ ä¾‹å¦‚ï¼šsudo bash debian_update.sh"
  exit 1
fi

# æ›´æ–°æºç´¢å¼•
echo "ğŸ”„ æ­£åœ¨æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•..."
apt update -y

# æ‰§è¡Œå®Œæ•´å‡çº§
echo "â¬†ï¸ æ­£åœ¨æ‰§è¡Œå®Œæ•´ç³»ç»Ÿå‡çº§..."
apt full-upgrade -y

# æ¸…ç†æ— ç”¨åŒ…ä¸ç¼“å­˜
echo "ğŸ§¹ æ¸…ç†æ—§åŒ…ä¸ç¼“å­˜..."
apt autoremove -y
apt autoclean

# æ˜¾ç¤ºç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯
echo "âœ… å½“å‰ç³»ç»Ÿç‰ˆæœ¬ï¼š"
lsb_release -a 2>/dev/null || cat /etc/debian_version

# æ£€æŸ¥æ˜¯å¦éœ€è¦é‡å¯
if [ -f /var/run/reboot-required ]; then
  echo "ğŸ” ç³»ç»Ÿæ›´æ–°å®Œæˆï¼Œéœ€è¦é‡å¯ã€‚"
  echo "ğŸ‘‰ æ‰§è¡Œå‘½ä»¤ï¼šsudo reboot"
else
  echo "âœ… ç³»ç»Ÿå·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œæ— éœ€é‡å¯ã€‚"
fi

echo "========================================"
echo "ğŸ‰ ç³»ç»Ÿæ›´æ–°å®Œæˆ $(date)"
echo "========================================"